{% extends "base.html" %}

{% block title %}模型训练流水线 - 金融风控AI系统{% endblock %}

{% block header %}
<div class="flex items-center gap-4 w-full">
    <button onclick="const h=window.location.hostname; const t='http://'+(h==='100.100.135.172'?'100.100.135.172':'localhost')+':9090'; console.log('Debug跳转: Host=', h, 'Target=', t); window.location.href=t;" 
            class="p-2 rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors"
            title="返回">
        <span class="material-symbols-outlined text-[20px]">arrow_back</span>
    </button>
    <h2 class="text-[11px] font-semibold text-slate-500 flex items-center gap-2">
    <span>Projects</span>
    <span class="text-slate-700">/</span>
    <span>Financial Risk</span>
    <span class="text-slate-700">/</span>
    <span class="text-slate-500 uppercase tracking-wider">Pipeline V2.4</span>
    </h2>
    <div class="ml-auto flex items-center gap-4">
        <div class="flex items-center gap-2 px-2.5 py-1 rounded-md bg-green-50 border border-green-200">
            <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span>
            <span class="text-[10px] font-bold text-green-700 uppercase tracking-wide">Training Nodes Online</span>
        </div>
        <div class="h-4 w-px bg-slate-200"></div>
        <button class="text-slate-500 hover:text-slate-900 transition-colors">
            <span class="material-symbols-outlined text-lg">notifications</span>
        </button>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="max-w-[1400px] mx-auto w-full space-y-8">
    <div class="flex flex-col gap-2">
        <h1 class="text-2xl font-bold text-slate-900 tracking-tight">模型训练流水线</h1>
        <p class="text-slate-500 text-xs font-medium">
            端到端风控AI工作流结构概览 · Version 2.4.0-LTS · Updated 2 hours ago
        </p>
    </div>

    <!-- Performance Metrics -->
    <section class="space-y-4">
        <div class="flex justify-between items-end border-b border-slate-200 pb-3">
            <h3 class="text-base font-semibold text-slate-800 flex items-center gap-2 uppercase tracking-wide">
                <span class="material-symbols-outlined text-slate-400">bar_chart</span>
                Performance Metrics
            </h3>
            <button class="text-primary hover:text-blue-700 text-sm font-medium flex items-center gap-1 transition-colors px-2 py-1 rounded hover:bg-blue-50">
                 View History <span class="material-symbols-outlined text-base">history</span>
            </button>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Baseline Card -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition-all duration-300 h-full">
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center gap-3">
                        <span class="w-3 h-3 rounded-full bg-slate-400 ring-4 ring-slate-100"></span>
                        <span class="text-sm font-bold text-slate-600 uppercase tracking-wide">开箱评测 (Out-of-the-box)</span>
                    </div>
                    <span class="px-2.5 py-1 bg-slate-100 text-slate-500 text-[10px] font-mono font-bold rounded border border-slate-200">BASELINE</span>
                </div>
                <div class="grid grid-cols-2 gap-8 lg:gap-12 mb-6">
                    <div class="space-y-3">
                        <div class="flex justify-between items-baseline">
                            <span class="text-sm font-medium text-slate-500">Precision (查准率)</span>
                            <span class="text-3xl font-bold text-slate-800 tracking-tight">35.5%</span>
                        </div>
                        <div class="w-full bg-slate-100 h-2.5 rounded-full overflow-hidden">
                            <div class="bg-slate-400 h-full rounded-full" style="width: 35.5%"></div>
                        </div>
                        <div class="pt-1 text-xs text-slate-400 font-mono">P = TP/(TP+FP)</div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-baseline">
                            <span class="text-sm font-medium text-slate-500">Recall (查全率)</span>
                            <span class="text-3xl font-bold text-slate-800 tracking-tight">54.5%</span>
                        </div>
                        <div class="w-full bg-slate-100 h-2.5 rounded-full overflow-hidden">
                            <div class="bg-slate-400 h-full rounded-full" style="width: 54.5%"></div>
                        </div>
                        <div class="pt-1 text-xs text-slate-400 font-mono">R = TP/(TP+FN)</div>
                    </div>
                </div>
                <div class="border-t border-slate-200 pt-4 mt-4">
                    <div class="grid grid-cols-2 gap-x-8 gap-y-4">
                        <div class="text-center bg-slate-50 p-3 rounded-lg border border-slate-200">
                            <div class="text-xs text-slate-500 font-medium">TP (真正例)</div>
                            <div class="text-xl font-bold text-slate-800">23</div>
                        </div>
                        <div class="text-center bg-slate-50 p-3 rounded-lg border border-slate-200">
                            <div class="text-xs text-slate-500 font-medium">FP (假正例)</div>
                            <div class="text-xl font-bold text-slate-800">42</div>
                        </div>
                        <div class="text-center bg-slate-50 p-3 rounded-lg border border-slate-200">
                            <div class="text-xs text-slate-500 font-medium">TN (真负例)</div>
                            <div class="text-xl font-bold text-slate-800">333</div>
                        </div>
                        <div class="text-center bg-slate-50 p-3 rounded-lg border border-slate-200">
                            <div class="text-xs text-slate-500 font-medium">FN (假负例)</div>
                            <div class="text-xl font-bold text-slate-800">19</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Optimized Card -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-primary/20 relative overflow-hidden group hover:shadow-md transition-all duration-300 h-full">
                <div class="absolute top-0 right-0 p-3 bg-primary/5 rounded-bl-2xl border-b border-l border-primary/10">
                    <span class="material-symbols-outlined text-primary text-xl">auto_awesome</span>
                </div>
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center gap-3">
                        <span class="relative flex h-3 w-3">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-3 w-3 bg-primary"></span>
                        </span>
                        <span class="text-sm font-bold text-primary uppercase tracking-wide">模型后训练 (Post-training)</span>
                    </div>
                    <span class="px-2.5 py-1 bg-blue-50 text-blue-600 text-[10px] font-mono font-bold rounded border border-blue-100">OPTIMIZED</span>
                </div>
                <div class="grid grid-cols-2 gap-8 lg:gap-12 mb-6">
                    <div class="space-y-3">
                        <div class="flex justify-between items-baseline">
                            <span class="text-sm font-medium text-slate-500">Precision (查准率)</span>
                            <span class="text-3xl font-bold text-primary tracking-tight">58.9%</span>
                        </div>
                        <div class="w-full bg-slate-100 h-2.5 rounded-full overflow-hidden">
                            <div class="bg-primary h-full rounded-full shadow-[0_0_10px_rgba(59,130,246,0.4)]" style="width: 58.9%"></div>
                        </div>
                        <div class="pt-1 flex items-center justify-between">
                            <span class="text-xs text-slate-400 font-mono">P = TP/(TP+FP)</span>
                            <span class="text-xs text-green-600 font-bold flex items-center bg-green-50 px-1.5 py-0.5 rounded border border-green-100">+23.4%</span>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-baseline">
                            <span class="text-sm font-medium text-slate-500">Recall (查全率)</span>
                            <span class="text-3xl font-bold text-primary tracking-tight">58.6%</span>
                        </div>
                        <div class="w-full bg-slate-100 h-2.5 rounded-full overflow-hidden">
                            <div class="bg-primary h-full rounded-full shadow-[0_0_10px_rgba(59,130,246,0.4)]" style="width: 58.6%"></div>
                        </div>
                        <div class="pt-1 flex items-center justify-between">
                            <span class="text-xs text-slate-400 font-mono">R = TP/(TP+FN)</span>
                            <span class="text-xs text-green-600 font-bold flex items-center bg-green-50 px-1.5 py-0.5 rounded border border-green-100">+4.1%</span>
                        </div>
                    </div>
                </div>
                <div class="border-t border-slate-200 pt-4 mt-4">
                    <div class="grid grid-cols-2 gap-x-8 gap-y-4">
                        <div class="text-center bg-blue-50/80 p-3 rounded-lg border border-blue-100">
                            <div class="text-xs text-blue-600 font-medium">TP (真正例)</div>
                            <div class="text-xl font-bold text-primary">25</div>
                        </div>
                        <div class="text-center bg-blue-50/80 p-3 rounded-lg border border-blue-100">
                            <div class="text-xs text-blue-600 font-medium">FP (假正例)</div>
                            <div class="text-xl font-bold text-primary">17</div>
                        </div>
                        <div class="text-center bg-blue-50/80 p-3 rounded-lg border border-blue-100">
                            <div class="text-xs text-blue-600 font-medium">TN (真负例)</div>
                            <div class="text-xl font-bold text-primary">358</div>
                        </div>
                        <div class="text-center bg-blue-50/80 p-3 rounded-lg border border-blue-100">
                            <div class="text-xs text-blue-600 font-medium">FN (假负例)</div>
                            <div class="text-xl font-bold text-primary">17</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- COT Diff -->
    <section class="space-y-4">
        <div class="flex justify-between items-center border-b border-slate-200 pb-3">
            <h3 class="text-base font-semibold text-slate-800 flex items-center gap-2 uppercase tracking-wide">
                <span class="material-symbols-outlined text-slate-400">difference</span>
                COT 输出过程差异对比(SIMPLEX OFFICE SOLUTIONS为例)
            </h3>
        </div>
        <div class="relative grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12 items-stretch">
            <!-- Before -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full hover:border-slate-300 transition-colors">
                <div class="px-5 py-3 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <span class="w-2.5 h-2.5 rounded-full bg-slate-300"></span>
                        <span class="text-xs font-bold text-slate-600 uppercase tracking-wider">Before (Out-of-box)</span>
                    </div>
                    <span class="material-symbols-outlined text-slate-300 text-sm">code</span>
                </div>
                <div class="p-6 bg-slate-50/30 flex-1">
                    <p class="font-mono text-sm leading-8 text-slate-600">
                        根据提供的企业数据报告，从多个维度进行违约风险分析：<br><br>1. **企业基本状况**：该企业为员工仅1人的新企业（成立时间短），通常意味着抗风险能力较弱且经营稳定性不足。但作为特许经营企业（特许经营代码为1），可能获得品牌支持和成熟商业模式，一定程度上降低了经营风险。<br><br>2. **贷款与还款情况**：贷款已全额偿还，MIS状态为“P I F”（Paid in Full），余额总额为0，核销本金总额为0，且无核销记录。这表明该笔贷款实际未发生违约，历史表现良好。<br><br>3. **现金流趋势**：半年流水呈波动上升趋势，从1,605.68增长至2,043.74，显示企业经营活动现金流逐步改善，具备还款能力。<br><br>4. **贷款条件与担保**：非低文档贷款（文档齐全），且有循环信贷额度，增加了资金灵活性。SBA担保比例为50%，虽然不直接影响企业违约概率，但表明贷款经过政府机构审核，风险相对可控。<br><br>5. **外部环境**：贷款发放时未处于经济衰退期（经济衰退期标志为0），宏观经济环境有利于企业经营。<br><br>综合分析，尽管企业规模小且为新企业，但现金流增长、贷款条件良好、且有特许经营背景，尤其是贷款已成功全额偿还，无违约记录。因此，判断该企业不存在违约风险。<br><br><strong>【答案】否</strong>
                    </p>
                </div>
            </div>

            <!-- Arrow -->
            <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 hidden lg:flex pointer-events-none">
                <div class="bg-white rounded-full p-3 border border-slate-200 shadow-xl">
                    <span class="material-symbols-outlined text-slate-400 text-xl">arrow_forward</span>
                </div>
            </div>

            <!-- After -->
            <div class="bg-white rounded-2xl shadow-sm border border-primary/40 overflow-hidden ring-4 ring-primary/5 h-full flex flex-col hover:shadow-md transition-all">
                <div class="px-5 py-3 bg-blue-50/50 border-b border-blue-100 flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <span class="w-2.5 h-2.5 rounded-full bg-primary shadow-[0_0_8px_rgba(59,130,246,0.6)] animate-pulse"></span>
                        <span class="text-xs font-bold text-primary uppercase tracking-wider">After (Post-training)</span>
                    </div>
                    <span class="material-symbols-outlined text-blue-300 text-sm">auto_fix_high</span>
                </div>
                <div class="p-6 bg-white flex-1">
                    <p class="font-mono text-sm leading-8 text-slate-800">
                        <strong>思考过程：</strong><br><br>遵循【风险分析框架】与【强制约束】，对该企业进行多维度交叉分析：<br><br>1.  <strong>企业运营动态稳定性（高风险）</strong>：<br>    *   <strong>存续状态</strong>：<span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200">为“新设企业”(NewExist=1)，缺乏可验证的运营历史，其商业模式、管理能力和现金流稳定性均未经考验，是固有高风险点。</span><br>    *   <strong>员工规模与就业变动</strong>：<span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200">员工仅1人，且贷款项目“创造岗位数”和“保留岗位数”均为0。这表明贷款并未用于扩张或稳定团队，与企业增长动态脱节，可能意味着贷款用途不明或业务规模极小，运营极为脆弱。</span><br><br>2.  <strong>贷款保障机制协同性（中高风险）</strong>：<br>    *   <strong>担保与抵押</strong>：SBA担保比例为50%，提供了部分风险缓释。但<span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200">关键风险在于“抵押标识”为0（无不动产抵押），使得银行在第二还款来源上依赖不足</span>，与“新设、微小企业”的高风险特征叠加时，保障协同性不足。<br>    *   <strong>贷款额度与期限</strong>：贷款额度（3万美元）与SBA担保额（1.5万美元）对于微小企业而言属合理范围，36个月期限也属常规。但结合其运营稳定性差的特征，还款能力存疑。<br><br>3.  <strong>行业-经济环境匹配度（中低风险）</strong>：<br>    *   <strong>行业与周期</strong>：行业为“办公设备租赁”(NAICS 532420)，属于服务于企业端的行业，受经济周期影响较明显。所幸申请时“不处于经济衰退期”(Recession=0)，宏观环境有利。企业位于城市(UrbanRural=0)，市场机会多但竞争也激烈。<br>    *   <strong>交叉验证矛盾点</strong>：在有利的行业环境下，一家新设企业却未计划创造任何就业，其发展意愿和贷款真实用途需要打问号。<br><br>4.  <strong>银行风控地域适配性（需关注）</strong>：<br>    *   <strong>流程与类型</strong>：从批准到放款间隔21天，流程正常。“低文档贷款”标识为N，表明银行要求了相对完整的财务文档，这是严谨的表现。但存在“循环信贷”(RevLineCr=Y)。<br>    *   <strong>【双向验证启动】</strong>：关键矛盾出现——银行对一家<strong>员工仅1人、无历史业绩的新设企业</strong>授予了“循环信贷”额度。这通常意味着银行基于某种评估认为企业有持续、稳定的现金流需求与偿还能力。然而，该企业的“半年流水”虽然呈上升趋势，但期末绝对额仅为2，043.74美元，基数极低。<span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200"><strong>“循环信贷”的授予与“极低的流水基数”及“新设零雇员增长”的现实严重矛盾</strong></span>。这要么意味着银行风控过于宽松，要么企业提供了与基础运营数据不匹配的现金流预期，存在信息不对称或误判风险。<br><br><strong>综合分析：</strong><br>尽管存在SBA部分担保、非低文档贷款、非经济衰退期等有利因素，但<span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200">企业的核心风险在于：<strong>“新设企业”与“零雇员增长”所表征的极弱运营基础</strong>，与<strong>“无抵押”的保障缺口</strong>形成共振。</span><span class="bg-yellow-100 text-yellow-800 px-1 py-0.5 rounded border border-yellow-200">尤为关键的是，<strong>银行授予“循环信贷”的决定与企业微不足道的流水和员工规模存在逻辑冲突</strong>，这暴露了风险审查可能存在的重大瑕疵或企业信息可信度问题。</span><br>在多重负面因素交织，且核心风控逻辑出现矛盾的情况下，企业未来现金流不足以覆盖还款义务的可能性很高。<br><br><strong>【答案】是</strong>
                    </p>
                </div>
            </div>
        </div>
    </section>
    <div class="h-8"></div>
</div>
{% endblock %}